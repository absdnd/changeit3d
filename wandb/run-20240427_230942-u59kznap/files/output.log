/home/aharish2/miniconda3/envs/c3d/lib/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
@epoch-2 train 0.565
val 0.623
test 0.627
* validation accuracy improved *
best test accuracy 0.627
@epoch-3 train 0.621
val 0.637
test 0.644
* validation accuracy improved *
best test accuracy 0.644
@epoch-4 train 0.640
val 0.649
test 0.655
* validation accuracy improved *
best test accuracy 0.655
@epoch-5 train 0.652
val 0.660
test 0.663
* validation accuracy improved *
best test accuracy 0.663
@epoch-6 train 0.662
val 0.673
test 0.668
* validation accuracy improved *
best test accuracy 0.668
@epoch-7 train 0.670
val 0.675
test 0.675
* validation accuracy improved *
best test accuracy 0.675
Exception ignored in: <function WeakValueDictionary.__init__.<locals>.remove at 0x7f7aff9f2700>
Traceback (most recent call last):
  File "/home/aharish2/miniconda3/envs/c3d/lib/python3.8/weakref.py", line 103, in remove
    def remove(wr, selfref=ref(self), _atomic_removal=_remove_dead_weakref):
KeyboardInterrupt:
Traceback (most recent call last):
  File "changeit3d/notebooks/cs766/exp_c_listener_training.py", line 220, in <module>
    exp_c_train_listener(
  File "changeit3d/notebooks/cs766/exp_c_listener_training.py", line 97, in exp_c_train_listener
    train_results = single_epoch_train(model,
  File "/home/shared/changeit3d/changeit3d/models/listening_oriented.py", line 218, in single_epoch_train
    logits = listener(tokens, stimuli)
  File "/home/aharish2/miniconda3/envs/c3d/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/shared/changeit3d/changeit3d/models/listening_oriented.py", line 64, in forward
    return self.transformer_based_forward(tokens, stimuli)
  File "/home/shared/changeit3d/changeit3d/models/listening_oriented.py", line 32, in transformer_based_forward
    lang_feat = self.language_encoder(tokens.t())  # seq_len, batch_size, d_model
  File "/home/aharish2/miniconda3/envs/c3d/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/shared/changeit3d/changeit3d/models/listening_oriented.py", line 174, in forward
    src = self.encoder(src) * math.sqrt(self.d_model)
KeyboardInterrupt